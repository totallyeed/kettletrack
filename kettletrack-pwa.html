<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KettleTrack</title>
    <meta name="description" content="Dein pers√∂nlicher Kettlebell Trainingslog">
    <meta name="theme-color" content="#006b78">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="KettleTrack">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --off-white: #F0F2F4;
  --accent: #006b78;
  --accent-light: rgba(0, 107, 120, 0.12);
  --accent-border: rgba(0, 107, 120, 0.25);
  --text-primary: #1C1C1E;
  --text-secondary: #6b7280;
  --glass-bg: rgba(255, 255, 255, 0.65);
  --glass-bg-strong: rgba(255, 255, 255, 0.85);
  --glass-border: rgba(255, 255, 255, 0.8);
  --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
  --blur: blur(20px);
  --radius: 1.25rem;
  --radius-sm: 0.75rem;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: var(--off-white);
  min-height: 100vh;
  color: var(--text-primary);
  overflow-x: hidden;
}

/* ===== BACKGROUND ===== */
.bg-gradient {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background:
    radial-gradient(ellipse at 20% 20%, rgba(0, 107, 120, 0.12) 0%, transparent 60%),
    radial-gradient(ellipse at 80% 80%, rgba(0, 107, 120, 0.08) 0%, transparent 60%),
    linear-gradient(180deg, #F0F2F4 0%, #E8ECEF 100%);
  z-index: 0;
}

/* ===== LAYOUT ===== */
.app-wrapper {
  position: relative;
  z-index: 1;
  max-width: 48rem;
  margin: 0 auto;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  padding: 0 0 1rem 0;
}

/* ===== HEADER ===== */
.app-header {
  padding: 3.5rem 1.5rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.app-header-left h1 {
  font-size: 2rem;
  font-weight: 700;
  letter-spacing: -0.03em;
  color: var(--text-primary);
  line-height: 1;
}

.app-header-left p {
  font-size: 0.875rem;
  color: var(--text-secondary);
  margin-top: 0.25rem;
}

.header-badge {
  background: var(--accent-light);
  border: 1px solid var(--accent-border);
  color: var(--accent);
  font-size: 0.75rem;
  font-weight: 600;
  padding: 0.375rem 0.75rem;
  border-radius: 999px;
  letter-spacing: 0.02em;
}

/* ===== MAIN CONTENT AREA ===== */
.main-content {
  flex: 1;
  padding: 0 1rem;
  overflow-y: auto;
}

/* ===== GLASS CARD ===== */
.glass-card {
  background: var(--glass-bg);
  backdrop-filter: var(--blur);
  -webkit-backdrop-filter: var(--blur);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  box-shadow: var(--glass-shadow);
  padding: 1.5rem;
  margin-bottom: 1rem;
}

.glass-card-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 1.25rem;
  letter-spacing: -0.01em;
}

/* ===== FORM ===== */
.form-group {
  margin-bottom: 1rem;
}

.form-grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.label {
  display: block;
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 0.4rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.input, .select {
  width: 100%;
  padding: 0.75rem 1rem;
  background: var(--glass-bg-strong);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: var(--radius-sm);
  font-size: 0.9375rem;
  color: var(--text-primary);
  outline: none;
  -webkit-appearance: none;
  appearance: none;
  transition: all 0.2s;
  min-height: 3rem;
}

.input:focus, .select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
  background: rgba(255,255,255,0.95);
}

.input::placeholder { color: #adb5bd; }
.input:disabled, .select:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

input[type="date"] { min-height: 3rem; }

/* ===== WEIGHT DROPDOWN SPECIAL ===== */
.weight-select-wrapper {
  position: relative;
}

.weight-select-wrapper::after {
  content: 'kg';
  position: absolute;
  right: 1rem;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.8rem;
  color: var(--accent);
  font-weight: 600;
  pointer-events: none;
}

/* ===== EXERCISE INFO BOX ===== */
.exercise-info-box {
  background: var(--accent-light);
  border: 1px solid var(--accent-border);
  border-radius: var(--radius-sm);
  padding: 1rem;
  margin-top: 0.75rem;
  animation: fadeSlideIn 0.3s ease-out;
}

@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateY(-8px); }
  to { opacity: 1; transform: translateY(0); }
}

.exercise-info-title {
  font-size: 0.7rem;
  font-weight: 700;
  color: var(--accent);
  margin-bottom: 0.6rem;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.exercise-info-stat {
  display: flex;
  align-items: baseline;
  gap: 0.5rem;
  margin-bottom: 0.3rem;
  font-size: 0.875rem;
}

.exercise-info-stat:last-child { margin-bottom: 0; }

.exercise-info-label {
  font-weight: 600;
  color: var(--accent);
  min-width: 5rem;
  font-size: 0.8rem;
}

.exercise-info-value {
  color: var(--text-primary);
  font-weight: 500;
}

/* ===== REPS BUILDER ===== */
.reps-builder {
  background: rgba(255,255,255,0.5);
  border: 1px solid rgba(0,0,0,0.07);
  border-radius: var(--radius-sm);
  padding: 0.75rem;
}

.reps-row {
  background: var(--glass-bg-strong);
  border: 1px solid rgba(0,0,0,0.07);
  border-radius: 0.625rem;
  padding: 0.75rem;
  margin-bottom: 0.5rem;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.reps-row:last-of-type { margin-bottom: 0.625rem; }

.reps-row-header {
  display: flex;
  gap: 0.5rem;
  align-items: center;
}

.reps-value-input {
  flex: 1;
  padding: 0.625rem 0.75rem;
  background: var(--off-white);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 0.5rem;
  font-size: 0.9375rem;
  color: var(--text-primary);
  outline: none;
  min-height: 2.75rem;
  transition: all 0.2s;
}

.reps-value-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

.reps-unit-select {
  width: 100%;
  padding: 0.625rem 0.75rem;
  background: var(--off-white);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 0.5rem;
  font-size: 0.9375rem;
  color: var(--text-primary);
  outline: none;
  min-height: 2.75rem;
  -webkit-appearance: none;
  appearance: none;
  transition: all 0.2s;
}

.reps-unit-select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-light);
}

.reps-custom-input {
  width: 100%;
  padding: 0.625rem 0.75rem;
  background: var(--off-white);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 0.5rem;
  font-size: 0.9375rem;
  color: var(--text-primary);
  outline: none;
  min-height: 2.75rem;
  transition: all 0.2s;
}

.reps-remove-btn {
  background: rgba(220, 38, 38, 0.08);
  border: 1px solid rgba(220, 38, 38, 0.2);
  color: #dc2626;
  font-size: 1.25rem;
  width: 2.75rem;
  height: 2.75rem;
  border-radius: 0.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: all 0.2s;
}

.reps-remove-btn:hover { background: rgba(220, 38, 38, 0.15); }
.reps-remove-btn:disabled { opacity: 0.3; cursor: not-allowed; }

.reps-add-btn {
  width: 100%;
  background: transparent;
  border: 1.5px dashed rgba(0, 107, 120, 0.3);
  color: var(--accent);
  font-size: 0.875rem;
  font-weight: 600;
  padding: 0.625rem;
  border-radius: 0.5rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.4rem;
  min-height: 2.5rem;
}

.reps-add-btn:hover { background: var(--accent-light); border-color: var(--accent); }

.reps-preview {
  background: var(--accent-light);
  border: 1px solid var(--accent-border);
  border-radius: 0.5rem;
  padding: 0.75rem;
  margin-top: 0.625rem;
}

.reps-preview-label {
  font-size: 0.7rem;
  font-weight: 700;
  color: var(--accent);
  margin-bottom: 0.2rem;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.reps-preview-value {
  color: var(--text-primary);
  font-size: 0.875rem;
  font-weight: 500;
  word-break: break-word;
}

/* ===== BUTTONS ===== */
.btn-primary {
  width: 100%;
  background: var(--accent);
  color: white;
  border: none;
  border-radius: var(--radius-sm);
  padding: 1rem;
  font-size: 0.9375rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  letter-spacing: 0.01em;
  margin-top: 0.5rem;
}

.btn-primary:hover {
  background: #005a65;
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(0, 107, 120, 0.3);
}

.btn-primary:active { transform: translateY(0); }
.btn-primary:disabled { background: #9ca3af; cursor: not-allowed; transform: none; }

.btn-secondary {
  background: var(--glass-bg-strong);
  border: 1px solid rgba(0,0,0,0.1);
  color: var(--text-primary);
  border-radius: var(--radius-sm);
  padding: 0.875rem 1rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-secondary:hover { background: white; border-color: rgba(0,0,0,0.15); }

.btn-danger {
  background: rgba(220, 38, 38, 0.08);
  border: 1px solid rgba(220, 38, 38, 0.2);
  color: #dc2626;
  border-radius: var(--radius-sm);
  padding: 0.875rem 1rem;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  width: 100%;
  margin-top: 0.5rem;
}

.btn-danger:hover { background: rgba(220, 38, 38, 0.15); }

.btn-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.625rem;
  margin-top: 0.625rem;
}

/* ===== ENTRIES LIST ===== */
.entries-list {
  max-height: 22rem;
  overflow-y: auto;
  margin-bottom: 0.75rem;
}

.entry-card {
  background: var(--glass-bg-strong);
  border: 1px solid rgba(0,0,0,0.06);
  border-radius: var(--radius-sm);
  padding: 0.875rem 1rem;
  margin-bottom: 0.5rem;
  transition: all 0.2s;
}

.entry-card:hover { background: white; }

.entry-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}

.entry-content { flex: 1; }

.entry-badges {
  display: flex;
  flex-wrap: wrap;
  gap: 0.375rem;
  margin-bottom: 0.4rem;
}

.badge {
  font-size: 0.7rem;
  padding: 0.2rem 0.5rem;
  border-radius: 999px;
  font-weight: 600;
  letter-spacing: 0.01em;
}

.badge-date { background: rgba(0,0,0,0.06); color: var(--text-secondary); }
.badge-day { background: var(--accent-light); color: var(--accent); }
.badge-round { background: var(--accent); color: white; }
.badge-weight { background: rgba(0,107,120,0.08); color: var(--accent); border: 1px solid var(--accent-border); }

.entry-exercise {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 0.2rem;
}

.entry-reps { font-size: 0.85rem; color: var(--text-secondary); }
.entry-notes { margin-left: 0.4rem; font-style: italic; color: #9ca3af; }

.delete-btn {
  background: none;
  border: none;
  color: #d1d5db;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  width: 2rem;
  height: 2rem;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: color 0.2s;
  flex-shrink: 0;
  margin-left: 0.5rem;
}

.delete-btn:hover { color: #dc2626; }

/* ===== SYNC CARD ===== */
.sync-status-box {
  background: var(--accent-light);
  border: 1px solid var(--accent-border);
  border-radius: var(--radius-sm);
  padding: 0.875rem;
  margin-bottom: 1rem;
  font-size: 0.875rem;
  color: var(--accent);
}

.sync-hint {
  display: flex;
  align-items: flex-start;
  gap: 0.5rem;
  margin-top: 0.75rem;
  font-size: 0.8125rem;
  color: var(--text-secondary);
}

/* ===== SETTINGS ===== */
.settings-item {
  padding: 1rem 0;
  border-bottom: 1px solid rgba(0,0,0,0.06);
}

.settings-item:last-child { border-bottom: none; }

.settings-label {
  font-size: 0.8rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 0.6rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.google-status {
  border-radius: var(--radius-sm);
  padding: 0.875rem;
  font-size: 0.875rem;
  margin-bottom: 0.75rem;
}

.google-status-disconnected {
  background: rgba(0,0,0,0.04);
  border: 1px solid rgba(0,0,0,0.08);
  color: var(--text-secondary);
}

.google-status-connected {
  background: var(--accent-light);
  border: 1px solid var(--accent-border);
  color: var(--accent);
}

.file-input {
  display: block;
  width: 100%;
  font-size: 0.875rem;
  color: var(--text-secondary);
}

.file-input::file-selector-button {
  margin-right: 1rem;
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  border: none;
  font-size: 0.875rem;
  font-weight: 600;
  background: var(--accent);
  color: white;
  cursor: pointer;
}

.help-text {
  margin-top: 0.5rem;
  font-size: 0.75rem;
  color: #9ca3af;
}

/* ===== TILE NAVIGATION ===== */
.tile-nav-wrapper {
  position: sticky;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 0 1rem 1rem;
  transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 100;
}

.tile-nav-wrapper.hidden {
  transform: translateY(calc(100% + 1rem));
}

.tile-nav-toggle {
  width: 100%;
  background: transparent;
  border: none;
  cursor: pointer;
  display: flex;
  justify-content: center;
  padding: 0.5rem;
  margin-bottom: 0.25rem;
}

.tile-nav-handle {
  width: 2.5rem;
  height: 0.25rem;
  background: rgba(0,0,0,0.15);
  border-radius: 999px;
  transition: background 0.2s;
}

.tile-nav-toggle:hover .tile-nav-handle { background: rgba(0,0,0,0.3); }

.tile-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 0.625rem;
}

.tile {
  background: var(--glass-bg);
  backdrop-filter: var(--blur);
  -webkit-backdrop-filter: var(--blur);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  padding: 1.25rem 1rem;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 0.5rem;
  box-shadow: 0 4px 16px rgba(0,0,0,0.06);
  min-height: 5rem;
}

.tile:hover {
  background: var(--glass-bg-strong);
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
}

.tile.active {
  background: var(--accent);
  border-color: var(--accent);
  box-shadow: 0 8px 24px rgba(0, 107, 120, 0.3);
}

.tile-icon {
  width: 2rem;
  height: 2rem;
  border-radius: 0.5rem;
  background: rgba(0,0,0,0.06);
  display: flex;
  align-items: center;
  justify-content: center;
}

.tile.active .tile-icon {
  background: rgba(255,255,255,0.2);
}

.tile-icon svg {
  width: 1.125rem;
  height: 1.125rem;
  stroke: var(--text-secondary);
  fill: none;
  stroke-width: 2;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.tile.active .tile-icon svg { stroke: white; }

.tile-label {
  font-size: 0.875rem;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -0.01em;
}

.tile.active .tile-label { color: white; }

.tile-count {
  font-size: 0.7rem;
  color: var(--text-secondary);
}

.tile.active .tile-count { color: rgba(255,255,255,0.8); }

/* Show tiles button (when hidden) */
.show-tiles-btn {
  position: fixed;
  bottom: 1.5rem;
  right: 1.5rem;
  background: var(--accent);
  border: none;
  border-radius: 999px;
  width: 3.5rem;
  height: 3.5rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 16px rgba(0, 107, 120, 0.4);
  z-index: 200;
  transition: all 0.3s;
}

.show-tiles-btn:hover {
  transform: scale(1.05);
  box-shadow: 0 6px 24px rgba(0, 107, 120, 0.5);
}

.show-tiles-btn svg {
  width: 1.5rem;
  height: 1.5rem;
  stroke: white;
  fill: none;
  stroke-width: 2.5;
  stroke-linecap: round;
  stroke-linejoin: round;
}

/* ===== SPINNER ===== */
.spinner {
  display: inline-block;
  width: 1rem;
  height: 1rem;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: white;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
}

@keyframes spin { to { transform: rotate(360deg); } }

/* ===== RESPONSIVE ===== */
@media (max-width: 640px) {
  .app-header { padding: 3rem 1rem 1rem; }
  .main-content { padding: 0 0.75rem; }
  .tile-nav-wrapper { padding: 0 0.75rem 0.75rem; }
  .glass-card { padding: 1.25rem; }
}
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useEffect, useCallback } = React;

const ICONS = {
  plus: <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
  list: <svg viewBox="0 0 24 24"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>,
  sync: <svg viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>,
  settings: <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>,
  chevronUp: <svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg>,
  menu: <svg viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>,
};

const WEIGHTS = ['', '4', '6', '8', '10', '12', '14', '16', '20', '24', '28', '32'];

const DEFAULT_PLAN = {
  'Montag': { label: 'Upper Body Push', exercises: ['Kettlebell Overhead Press', 'Kettlebell Floor Press', 'Liegest√ºtze'] },
  'Dienstag': { label: 'Lower Body + Core', exercises: ['Kettlebell Goblet Squat', 'Kettlebell Swing', 'Plank + Sit-ups'] },
  'Mittwoch': { label: 'Upper Body Pull + Core', exercises: ['Kettlebell Single-Arm Row', 'Kettlebell Gorilla Row', 'Two-Handed Kettlebell Bent-Over Row', 'Plank + Sit-ups', 'Bizeps Horn Curls (Finisher)'] },
  'Donnerstag': { label: 'Full Body HIIT', exercises: ['Kettlebell Swing', 'Kettlebell Goblet Squat', 'Kettlebell Overhead Press', 'Kettlebell Single-Arm Row'] },
  'Freitag': { label: 'Lower + Push', exercises: ['Kettlebell Goblet Squat', 'Kettlebell Swing', 'Kettlebell Floor Press', 'Liegest√ºtze'] },
  'Samstag': { label: 'Upper Body Pull + Core intensiv', exercises: ['Kettlebell Single-Arm Row', 'Kettlebell Gorilla Row', 'Two-Handed Kettlebell Bent-Over Row', 'Plank + Sit-ups', 'Bizeps Horn Curls (Finisher)'] },
  'Sonntag': { label: 'Active Full Body (leicht)', exercises: ['Kettlebell Swing', 'Kettlebell Goblet Squat', 'Kettlebell Overhead Press', 'Liegest√ºtze'] }
};

const GOOGLE_CLIENT_ID = '630449042583-30k2cfda9qmo12r6cadqp04ebkoe0haq.apps.googleusercontent.com';
const SCOPES = 'https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.readonly';

const TrainingLogForm = () => {
  const [activeSection, setActiveSection] = useState('newEntry');
  const [tilesHidden, setTilesHidden] = useState(false);
  const [entries, setEntries] = useState([]);
  const [trainingPlan, setTrainingPlan] = useState(null);
  const [exerciseHistory, setExerciseHistory] = useState({});
  const [googleAccessToken, setGoogleAccessToken] = useState(null);
  const [isGoogleAuthorized, setIsGoogleAuthorized] = useState(false);
  const [isSyncing, setIsSyncing] = useState(false);
  const [isSavingToDrive, setIsSavingToDrive] = useState(false);
  const [lastSyncTime, setLastSyncTime] = useState(null);

  const [currentEntry, setCurrentEntry] = useState({
    date: new Date().toISOString().split('T')[0],
    day: '', round: '1', exercise: '', weight: '', reps: '', notes: ''
  });

  const [repsRows, setRepsRows] = useState([
    { id: 1, value: '', unit: 'rechts', customUnit: '' }
  ]);

  const activePlan = trainingPlan || DEFAULT_PLAN;

  // ===== LOAD FROM LOCALSTORAGE =====
  useEffect(() => {
    const load = (key, setter) => {
      const saved = localStorage.getItem(key);
      if (saved) { try { setter(JSON.parse(saved)); } catch(e) {} }
    };
    load('kettletrack-entries', setEntries);
    load('kettletrack-plan', setTrainingPlan);
    load('kettletrack-exercise-history', setExerciseHistory);

    const syncTime = localStorage.getItem('kettletrack-last-sync');
    if (syncTime) setLastSyncTime(new Date(syncTime));

    const token = localStorage.getItem('google_access_token');
    if (token) { setGoogleAccessToken(token); setIsGoogleAuthorized(true); }

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(() => {});
    }
  }, []);

  useEffect(() => {
    if (entries.length > 0) localStorage.setItem('kettletrack-entries', JSON.stringify(entries));
  }, [entries]);

  useEffect(() => {
    if (trainingPlan) localStorage.setItem('kettletrack-plan', JSON.stringify(trainingPlan));
  }, [trainingPlan]);

  useEffect(() => {
    if (Object.keys(exerciseHistory).length > 0)
      localStorage.setItem('kettletrack-exercise-history', JSON.stringify(exerciseHistory));
  }, [exerciseHistory]);

  // ===== REPS =====
  useEffect(() => {
    const str = repsRows
      .filter(r => r.value.trim())
      .map(r => r.unit === 'Freitext' && r.customUnit ? `${r.value} ${r.customUnit}` : `${r.value} ${r.unit}`)
      .join(' | ');
    setCurrentEntry(prev => ({ ...prev, reps: str }));
  }, [repsRows]);

  const addRepsRow = () => {
    setRepsRows(prev => [...prev, { id: Date.now(), value: '', unit: 'rechts', customUnit: '' }]);
  };

  const removeRepsRow = (id) => {
    if (repsRows.length > 1) setRepsRows(prev => prev.filter(r => r.id !== id));
  };

  const updateRepsRow = (id, field, value) => {
    setRepsRows(prev => prev.map(r => r.id === id ? { ...r, [field]: value } : r));
  };

  // ===== EXERCISE HISTORY =====
  const updateExerciseHistory = useCallback((newEntries) => {
    setExerciseHistory(prev => {
      const history = { ...prev };
      for (const entry of newEntries) {
        if (!entry.exercise || !entry.reps) continue;
        if (!history[entry.exercise]) history[entry.exercise] = [];
        const repsDisplay = entry.weight ? `${entry.weight}kg - ${entry.reps}` : entry.reps;
        history[entry.exercise].push({ reps: repsDisplay, date: entry.date, notes: entry.notes || '' });
        history[entry.exercise].sort((a, b) => new Date(b.date) - new Date(a.date));
        history[entry.exercise] = history[entry.exercise].slice(0, 10);
      }
      return history;
    });
  }, []);

  const getExerciseStats = (name) => {
    const h = exerciseHistory[name];
    if (!h || h.length === 0) return null;
    return { recent: h.slice(0, 3).map(x => x.reps) };
  };

  // ===== PARSERS =====
  const parseTrainingPlan = (text) => {
    const lines = text.split('\n').filter(l => l.trim().startsWith('|'));
    const plan = {};
    lines.slice(2).forEach(line => {
      const cells = line.split('|').map(c => c.trim()).filter(Boolean);
      if (cells.length >= 4) {
        const day = cells[1], focus = cells[2], exercisesText = cells[3];
        const matches = exercisesText.match(/\d+\\?\.\s*([^0-9]+?)(?=\s*\d+\\?\.|$)/g);
        const exercises = matches ? matches.map(ex => ex.replace(/^\d+\\?\.\s*/, '').replace(/\s*\(.*?\)/g, '').trim()) : [];
        if (day && exercises.length > 0) plan[day] = { label: focus, exercises };
      }
    });
    return Object.keys(plan).length > 0 ? plan : null;
  };

  const parseGoogleDoc = (content) => {
    const parsed = [];
    const matches = [...content.matchAll(/Eintrag \d+:/g)];
    let blocks = [];
    if (matches.length > 0) {
      for (let i = 0; i < matches.length; i++) {
        const start = matches[i].index;
        const end = i < matches.length - 1 ? matches[i + 1].index : content.length;
        blocks.push(content.substring(start, end));
      }
    } else {
      blocks = content.split(/\n[-=]{30,}\n/).filter(b => b.trim());
    }
    for (const block of blocks) {
      const entry = {};
      for (const line of block.split('\n').map(l => l.trim()).filter(l => l)) {
        if (line.startsWith('Datum:')) entry.date = line.replace('Datum:', '').trim();
        else if (line.startsWith('Trainingstag:')) entry.day = line.replace('Trainingstag:', '').trim();
        else if (line.startsWith('Runde:')) entry.round = line.replace('Runde:', '').trim();
        else if (line.startsWith('√úbung:')) entry.exercise = line.replace('√úbung:', '').trim();
        else if (line.startsWith('Gewicht:')) entry.weight = line.replace('Gewicht:', '').trim();
        else if (line.startsWith('Reps/Dauer:')) entry.reps = line.replace('Reps/Dauer:', '').trim();
        else if (line.startsWith('Notizen:')) entry.notes = line.replace('Notizen:', '').trim();
      }
      if (entry.date && entry.day && entry.exercise && entry.reps)
        parsed.push({ ...entry, id: Date.now() + Math.random() });
    }
    return parsed;
  };

  // ===== GOOGLE AUTH =====
  const handleGoogleLogin = async () => {
    try {
      const client = google.accounts.oauth2.initTokenClient({
        client_id: GOOGLE_CLIENT_ID, scope: SCOPES,
        callback: (response) => {
          if (response.access_token) {
            setGoogleAccessToken(response.access_token);
            setIsGoogleAuthorized(true);
            localStorage.setItem('google_access_token', response.access_token);
          }
        },
      });
      client.requestAccessToken();
    } catch (e) { alert('Anmeldung fehlgeschlagen.'); }
  };

  const handleGoogleLogout = () => {
    setGoogleAccessToken(null); setIsGoogleAuthorized(false);
    localStorage.removeItem('google_access_token');
  };

  // ===== SYNC =====
  const syncLastSevenDays = async () => {
    if (!isGoogleAuthorized) {
      if (confirm('Jetzt mit Google anmelden?')) await handleGoogleLogin();
      return;
    }
    try {
      setIsSyncing(true);
      const sevenDaysAgo = new Date();
      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
      const params = new URLSearchParams({
        q: `name contains 'KettleTrack_Log_' and mimeType='application/vnd.google-apps.document' and modifiedTime > '${sevenDaysAgo.toISOString()}' and trashed=false`,
        fields: 'files(id, name, modifiedTime)', orderBy: 'modifiedTime desc'
      });
      const res = await fetch(`https://www.googleapis.com/drive/v3/files?${params}`, {
        headers: { Authorization: `Bearer ${googleAccessToken}` }
      });
      if (!res.ok) throw new Error('Search failed');
      const { files = [] } = await res.json();
      if (files.length === 0) { alert('Keine Logs der letzten 7 Tage gefunden.'); setIsSyncing(false); return; }
      const allEntries = [];
      for (const file of files) {
        const r = await fetch(`https://www.googleapis.com/drive/v3/files/${file.id}/export?mimeType=text/plain`, {
          headers: { Authorization: `Bearer ${googleAccessToken}` }
        });
        if (r.ok) allEntries.push(...parseGoogleDoc(await r.text()));
      }
      updateExerciseHistory(allEntries);
      const now = new Date();
      setLastSyncTime(now);
      localStorage.setItem('kettletrack-last-sync', now.toISOString());
      setIsSyncing(false);
      alert(`Sync erfolgreich!\n${files.length} Dateien, ${allEntries.length} Eintr√§ge`);
    } catch (e) {
      setIsSyncing(false);
      if (e.message?.includes('401')) {
        localStorage.removeItem('google_access_token');
        setGoogleAccessToken(null); setIsGoogleAuthorized(false);
        alert('Anmeldung abgelaufen.');
      } else alert(`Fehler: ${e.message}`);
    }
  };

  // ===== DRIVE SAVE =====
  const findOrCreateFolder = async (token, name, parentId = null) => {
    const q = `name='${name}' and mimeType='application/vnd.google-apps.folder' and trashed=false${parentId ? ` and '${parentId}' in parents` : ''}`;
    const r = await fetch(`https://www.googleapis.com/drive/v3/files?${new URLSearchParams({ q, fields: 'files(id)' })}`, {
      headers: { Authorization: `Bearer ${token}` }
    });
    const d = await r.json();
    if (d.files?.length > 0) return d.files[0].id;
    const meta = { name, mimeType: 'application/vnd.google-apps.folder' };
    if (parentId) meta.parents = [parentId];
    const cr = await fetch('https://www.googleapis.com/drive/v3/files', {
      method: 'POST', headers: { Authorization: `Bearer ${token}`, 'Content-Type': 'application/json' },
      body: JSON.stringify(meta)
    });
    return (await cr.json()).id;
  };

  const saveToGoogleDrive = async () => {
    if (entries.length === 0) { alert('Keine Eintr√§ge zum Speichern!'); return; }
    if (!isGoogleAuthorized) {
      if (confirm('Jetzt mit Google anmelden?')) await handleGoogleLogin();
      return;
    }
    try {
      setIsSavingToDrive(true);
      const folderId = await findOrCreateFolder(googleAccessToken, 'KettleTrack');
      const logsFolderId = await findOrCreateFolder(googleAccessToken, 'Logs', folderId);
      const title = `KettleTrack_Log_${new Date().toISOString().split('T')[0]}`;
      let content = `KettleTrack Training Log\nDatum: ${new Date().toLocaleDateString('de-DE')}\nAnzahl Eintr√§ge: ${entries.length}\n\n${'='.repeat(100)}\n\n`;
      entries.forEach((e, i) => {
        content += `Eintrag ${i + 1}:\n  Datum: ${e.date}\n  Trainingstag: ${e.day}\n  Runde: ${e.round}\n  √úbung: ${e.exercise}\n`;
        if (e.weight) content += `  Gewicht: ${e.weight}kg\n`;
        content += `  Reps/Dauer: ${e.reps}\n`;
        if (e.notes) content += `  Notizen: ${e.notes}\n`;
        content += `\n${'-'.repeat(100)}\n\n`;
      });
      const boundary = '-------314159265358979323846';
      const body = `\r\n--${boundary}\r\nContent-Type: application/json; charset=UTF-8\r\n\r\n${JSON.stringify({ name: title, mimeType: 'application/vnd.google-apps.document', parents: [logsFolderId] })}\r\n--${boundary}\r\nContent-Type: text/plain; charset=UTF-8\r\n\r\n${content}\r\n--${boundary}--`;
      const r = await fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
        method: 'POST', headers: { Authorization: `Bearer ${googleAccessToken}`, 'Content-Type': `multipart/related; boundary=${boundary}` }, body
      });
      if (!r.ok) throw new Error(`${r.status}`);
      updateExerciseHistory(entries);
      setIsSavingToDrive(false);
      alert(`Gespeichert!\nDatei: ${title}\n${entries.length} Eintr√§ge`);
    } catch (e) {
      setIsSavingToDrive(false);
      alert(`Fehler: ${e.message}`);
    }
  };

  // ===== FORM =====
  const handleInputChange = (field, value) => {
    setCurrentEntry(prev => ({ ...prev, [field]: value, ...(field === 'day' ? { exercise: '' } : {}) }));
  };

  const addEntry = () => {
    if (!currentEntry.day || !currentEntry.exercise || !currentEntry.reps) {
      alert('Bitte f√ºlle Tag, √úbung und Reps aus!'); return;
    }
    const newEntry = { ...currentEntry, id: Date.now() };
    setEntries(prev => [...prev, newEntry]);
    updateExerciseHistory([newEntry]);
    setCurrentEntry(prev => ({ ...prev, exercise: '', weight: '', reps: '', notes: '' }));
    setRepsRows([{ id: Date.now(), value: '', unit: 'rechts', customUnit: '' }]);
  };

  const removeEntry = (id) => setEntries(prev => prev.filter(e => e.id !== id));

  const clearAllEntries = () => {
    if (confirm(`Alle ${entries.length} Eintr√§ge l√∂schen?`)) {
      setEntries([]); localStorage.removeItem('kettletrack-entries');
    }
  };

  // ===== EXPORT =====
  const formatEntry = (e) => `| ${e.date} | ${e.day} | ${e.round} | ${e.exercise} | ${e.weight ? e.weight + 'kg' : '‚Äî'} | ${e.reps} | ${e.notes || '‚Äî'} |`;

  const generateMarkdown = () => {
    if (entries.length === 0) { alert('Keine Eintr√§ge!'); return; }
    const md = `| Datum | Trainingstag | Runde | √úbung | Gewicht | Reps / Dauer | Notizen |\n| --- | --- | --- | --- | --- | --- | --- |\n${entries.map(formatEntry).join('\n')}`;
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([md], { type: 'text/markdown' }));
    a.download = `training_log_${new Date().toISOString().split('T')[0]}.md`;
    a.click();
  };

  const copyToClipboard = () => {
    if (entries.length === 0) { alert('Keine Eintr√§ge!'); return; }
    const md = `| Datum | Trainingstag | Runde | √úbung | Gewicht | Reps / Dauer | Notizen |\n| --- | --- | --- | --- | --- | --- | --- |\n${entries.map(formatEntry).join('\n')}`;
    navigator.clipboard.writeText(md).then(() => alert('Kopiert!')).catch(() => alert('Fehler beim Kopieren'));
  };

  const handleFileUpload = (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (ev) => {
      const plan = parseTrainingPlan(ev.target.result);
      if (plan) { setTrainingPlan(plan); alert('Trainingsplan geladen!'); }
      else alert('Format nicht erkannt.');
    };
    reader.readAsText(file);
  };

  // ===== HELPERS =====
  const currentExercises = currentEntry.day && activePlan[currentEntry.day] ? activePlan[currentEntry.day].exercises : [];
  const exerciseStats = currentEntry.exercise ? getExerciseStats(currentEntry.exercise) : null;
  const formatSyncTime = () => !lastSyncTime ? 'Noch nie synchronisiert' : lastSyncTime.toLocaleString('de-DE', { day: '2-digit', month: '2-digit', year: '2-digit', hour: '2-digit', minute: '2-digit' });

  const SECTIONS = {
    newEntry: 'Neuer Eintrag',
    myEntries: `Eintr√§ge${entries.length > 0 ? ` (${entries.length})` : ''}`,
    sync: 'Synchronisierung',
    settings: 'Einstellungen',
  };

  const TILE_ICONS = {
    newEntry: ICONS.plus,
    myEntries: ICONS.list,
    sync: ICONS.sync,
    settings: ICONS.settings,
  };

  const TILE_SUB = {
    newEntry: 'Training erfassen',
    myEntries: entries.length === 0 ? 'Keine Eintr√§ge' : `${entries.length} Eintr√§ge`,
    sync: lastSyncTime ? formatSyncTime() : 'Nicht synchronisiert',
    settings: 'Google Drive & Plan',
  };

  // ===== RENDER =====
  return (
  // ===== RENDER =====
  return (
    <>
      <div className="bg-gradient" />
      <div className="app-wrapper">
        {/* HEADER */}
        <div className="app-header">
          <div className="app-header-left">
            <h1>KettleTrack</h1>
            <p>{SECTIONS[activeSection]}</p>
          </div>
          <div className="header-badge">v2.1</div>
        </div>

        {/* MAIN CONTENT */}
        <div className="main-content">

          {/* ===== NEUER EINTRAG ===== */}
          {activeSection === 'newEntry' && (
            <div className="glass-card">
              <div className="form-grid-2">
                <div className="form-group">
                  <label className="label">Datum</label>
                  <input type="date" value={currentEntry.date}
                    onChange={e => handleInputChange('date', e.target.value)} className="input" />
                </div>
                <div className="form-group">
                  <label className="label">Runde</label>
                  <input type="number" min="1" value={currentEntry.round}
                    onChange={e => handleInputChange('round', e.target.value)}
                    className="input" placeholder="1" />
                </div>
              </div>

              <div className="form-group">
                <label className="label">Trainingstag</label>
                <select value={currentEntry.day}
                  onChange={e => handleInputChange('day', e.target.value)} className="select">
                  <option value="">Tag w√§hlen</option>
                  {Object.entries(activePlan).map(([day, data]) => (
                    <option key={day} value={day}>{day} ‚Äì {data.label}</option>
                  ))}
                </select>
              </div>

              <div className="form-group">
                <label className="label">√úbung</label>
                <select value={currentEntry.exercise}
                  onChange={e => handleInputChange('exercise', e.target.value)}
                  disabled={!currentEntry.day} className="select">
                  <option value="">√úbung w√§hlen</option>
                  {currentExercises.map(ex => <option key={ex} value={ex}>{ex}</option>)}
                </select>
                {exerciseStats && (
                  <div className="exercise-info-box">
                    <div className="exercise-info-title">Letzte Sessions</div>
                    <div>
                      {exerciseStats.recent.map((reps, idx) => (
                        <div key={idx} className="exercise-info-stat">
                          <span className="exercise-info-label">
                            {idx === 0 ? 'Letztes Mal' : `${idx + 1}. davor`}
                          </span>
                          <span className="exercise-info-value">{reps}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>

              <div className="form-group">
                <label className="label">Gewicht (optional)</label>
                <select value={currentEntry.weight}
                  onChange={e => handleInputChange('weight', e.target.value)} className="select">
                  <option value="">Kein Gewicht</option>
                  {WEIGHTS.filter(w => w !== '').map(w => (
                    <option key={w} value={w}>{w} kg</option>
                  ))}
                </select>
              </div>

              <div className="form-group">
                <label className="label">Reps / Dauer</label>
                <div className="reps-builder">
                  {repsRows.map(row => (
                    <div key={row.id} className="reps-row">
                      <div className="reps-row-header">
                        <input type="text" value={row.value}
                          onChange={e => updateRepsRow(row.id, 'value', e.target.value)}
                          placeholder="Anzahl" className="reps-value-input" />
                        <button type="button" onClick={() => removeRepsRow(row.id)}
                          disabled={repsRows.length === 1} className="reps-remove-btn">√ó</button>
                      </div>
                      <select value={row.unit}
                        onChange={e => updateRepsRow(row.id, 'unit', e.target.value)}
                        className="reps-unit-select">
                        <option value="rechts">rechts</option>
                        <option value="links">links</option>
                        <option value="gesamt">gesamt</option>
                        <option value="Sekunden">Sekunden</option>
                        <option value="Freitext">Freitext</option>
                      </select>
                      {row.unit === 'Freitext' && (
                        <input type="text" value={row.customUnit}
                          onChange={e => updateRepsRow(row.id, 'customUnit', e.target.value)}
                          placeholder="z.B. Sit-ups, Satz 1" className="reps-custom-input" />
                      )}
                    </div>
                  ))}
                  <button type="button" onClick={addRepsRow} className="reps-add-btn">
                    <span>+</span><span>Weitere hinzuf√ºgen</span>
                  </button>
                  {currentEntry.reps && (
                    <div className="reps-preview">
                      <div className="reps-preview-label">Vorschau</div>
                      <div className="reps-preview-value">
                        {currentEntry.weight ? `${currentEntry.weight}kg ‚Äì ` : ''}{currentEntry.reps}
                      </div>
                    </div>
                  )}
                </div>
              </div>

              <div className="form-group">
                <label className="label">Notizen (optional)</label>
                <input type="text" value={currentEntry.notes}
                  onChange={e => handleInputChange('notes', e.target.value)}
                  placeholder="z.B. Neuer Peak, sehr intensiv..." className="input" />
              </div>

              <button onClick={addEntry} className="btn-primary">
                Eintrag hinzuf√ºgen
              </button>
            </div>
          )}

          {/* ===== MEINE EINTR√ÑGE ===== */}
          {activeSection === 'myEntries' && (
            <div className="glass-card">
              {entries.length === 0 ? (
                <p style={{color: 'var(--text-secondary)', textAlign: 'center', padding: '2rem 0', fontSize: '0.9rem'}}>
                  Noch keine Eintr√§ge vorhanden.
                </p>
              ) : (
                <>
                  <div className="entries-list">
                    {entries.map(entry => (
                      <div key={entry.id} className="entry-card">
                        <div className="entry-row">
                          <div className="entry-content">
                            <div className="entry-badges">
                              <span className="badge badge-date">{entry.date}</span>
                              <span className="badge badge-day">{entry.day}</span>
                              <span className="badge badge-round">R{entry.round}</span>
                              {entry.weight && <span className="badge badge-weight">{entry.weight}kg</span>}
                            </div>
                            <div className="entry-exercise">{entry.exercise}</div>
                            <div className="entry-reps">
                              {entry.reps}
                              {entry.notes && <span className="entry-notes">¬∑ {entry.notes}</span>}
                            </div>
                          </div>
                          <button onClick={() => removeEntry(entry.id)} className="delete-btn">√ó</button>
                        </div>
                      </div>
                    ))}
                  </div>
                  <div className="btn-grid">
                    <button onClick={copyToClipboard} className="btn-secondary">Kopieren</button>
                    <button onClick={generateMarkdown} className="btn-secondary">Download</button>
                    <button onClick={saveToGoogleDrive} className="btn-primary" disabled={isSavingToDrive}
                      style={{gridColumn: 'span 2', marginTop: 0}}>
                      {isSavingToDrive ? <><span className="spinner"></span> Speichere...</> : 'In Drive speichern'}
                    </button>
                  </div>
                  <button onClick={clearAllEntries} className="btn-danger">
                    Alle Eintr√§ge l√∂schen
                  </button>
                </>
              )}
            </div>
          )}

          {/* ===== SYNCHRONISIERUNG ===== */}
          {activeSection === 'sync' && (
            <div className="glass-card">
              <div className="sync-status-box">
                <strong>Letzter Sync:</strong> {formatSyncTime()}
              </div>
              <button onClick={syncLastSevenDays} className="btn-primary" disabled={isSyncing}>
                {isSyncing ? <><span className="spinner"></span> Synchronisiere...</> : 'Jetzt synchronisieren'}
              </button>
              <div className="sync-hint">
                <span>üí°</span>
                <span>L√§dt die letzten 7 Tage aus Google Drive und aktualisiert deine Vergleichswerte</span>
              </div>
            </div>
          )}

          {/* ===== EINSTELLUNGEN ===== */}
          {activeSection === 'settings' && (
            <div className="glass-card">
              <div className="settings-item">
                <div className="settings-label">Trainingsplan hochladen</div>
                <input type="file" accept=".md,.txt" onChange={handleFileUpload} className="file-input" />
                <p className="help-text">Lade deinen Trainingsplan hoch (.md Format)</p>
              </div>
              <div className="settings-item">
                <div className="settings-label">Google Account</div>
                {isGoogleAuthorized ? (
                  <>
                    <div className="google-status google-status-connected">Mit Google Drive verbunden</div>
                    <button onClick={handleGoogleLogout} className="btn-secondary" style={{width: '100%'}}>
                      Abmelden
                    </button>
                  </>
                ) : (
                  <>
                    <div className="google-status google-status-disconnected">Nicht verbunden</div>
                    <button onClick={handleGoogleLogin} className="btn-primary">
                      Mit Google anmelden
                    </button>
                  </>
                )}
                <p className="help-text">Verbinde Google Drive um Logs zu speichern und zu synchronisieren</p>
              </div>
            </div>
          )}
        </div>

        {/* ===== TILE NAVIGATION ===== */}
        <div className={`tile-nav-wrapper ${tilesHidden ? 'hidden' : ''}`}>
          <button className="tile-nav-toggle" onClick={() => setTilesHidden(true)}>
            <div className="tile-nav-handle" />
          </button>
          <div className="tile-grid">
            {Object.keys(SECTIONS).map(key => (
              <div key={key} className={`tile ${activeSection === key ? 'active' : ''}`}
                onClick={() => setActiveSection(key)}>
                <div className="tile-icon">{TILE_ICONS[key]}</div>
                <div className="tile-label">{SECTIONS[key]}</div>
                <div className="tile-count">{TILE_SUB[key]}</div>
              </div>
            ))}
          </div>
        </div>

        {/* SHOW TILES BUTTON */}
        {tilesHidden && (
          <button className="show-tiles-btn" onClick={() => setTilesHidden(false)}>
            {ICONS.menu}
          </button>
        )}
      </div>
    </>
  );
};

ReactDOM.render(<TrainingLogForm />, document.getElementById('root'));
</script>
</body>
</html>
